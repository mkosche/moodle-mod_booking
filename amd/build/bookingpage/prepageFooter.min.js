define("mod_booking/bookingpage/prepageFooter",["exports","jquery","mod_booking/bookit","local_wunderbyte_table/reload"],(function(_exports,_jquery,_bookit,_reload){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.closeInline=closeInline,_exports.closeModal=closeModal,_exports.initFooterButtons=function(optionid,userid){_jquery.default.each((0,_jquery.default)("[id^="+SELECTORS_MODALID+optionid+"]"),(function(){(0,_jquery.default)(this).on("hide.bs.modal",(function(){(0,_bookit.setBackModalVariables)(optionid)}))})),async function(optionid){let modal=document.querySelector("div.modal.show[id^="+SELECTORS_MODALID+optionid+"]");if(!modal){if(document.querySelectorAll("div.inlineprepagearea [id^="+SELECTORS_INLINEID+optionid+"]").forEach((el=>{(function(el){var style=window.getComputedStyle(el);return"none"===style.display||"hidden"===style.visibility})(el)||(modal=el)})),!modal)return}modal.addEventListener("click",(e=>{let button=e.target;if(button){const bookingButtonArea=e.target.closest(SELECTORS_BOOKITBUTTON);if(button=e.target.closest(".btn"),bookingButtonArea&&button&&"noforward"==bookingButtonArea.dataset.action)return}}))}(optionid);let elements=document.querySelectorAll("[id^="+SELECTORS_MODALID+optionid+"] "+SELECTORS_INMODALFOOTER+" a");0===elements.length&&(elements=document.querySelectorAll("[id^="+SELECTORS_INLINEID+optionid+"] "+SELECTORS_INMODALFOOTER+" a"));console.log("elements",elements,"[id^="+SELECTORS_INLINEID+optionid+"] "+SELECTORS_INMODALFOOTER+" a"),elements.forEach((element=>{if(element&&!element.dataset.initialized){element.dataset.initialized=!0;const action=element.dataset.action;switch(action){case"closeinline":case"continuepost":case"checkout":console.log("closeinline"),("function"==typeof _systemImportTransformerGlobalIdentifier.define&&_systemImportTransformerGlobalIdentifier.define.amd?new Promise((function(resolve,reject){_systemImportTransformerGlobalIdentifier.require(["local_shopping_cart/cart"],resolve,reject)})):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&_systemImportTransformerGlobalIdentifier.require&&"component"===_systemImportTransformerGlobalIdentifier.require.loader?Promise.resolve(require("local_shopping_cart/cart")):Promise.resolve(_systemImportTransformerGlobalIdentifier["local_shopping_cart/cart"])).then((cart=>{window.location.href.indexOf("cashier.php")>0?cart.reinit(-1):cart.reinit()})).catch((e=>{console.log(e)})),function(optionid){_jquery.default.each((0,_jquery.default)("[id^="+SELECTORS_INLINEID+optionid+"]"),(function(){(0,_jquery.default)(this).on("hide.bs.collapse",(function(){(0,_reload.reloadAllTables)()}))}))}()}element.addEventListener("click",(()=>{if(!element.classList.contains("hidden")&&"true"!=element.dataset.blocked)switch(action){case"back":(0,_bookit.backToPreviousPage)(optionid,userid);break;case"continue":case"continuepost":(0,_bookit.continueToNextPage)(optionid,userid);break;case"checkout":closeModal(optionid),window.location.href=element.dataset.href;break;case"closemodal":closeModal(optionid);break;case"closeinline":closeInline(optionid)}}))}}))},_jquery=(obj=_jquery)&&obj.__esModule?obj:{default:obj};var _systemImportTransformerGlobalIdentifier="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{};var SELECTORS_MODALID="sbPrePageModal_",SELECTORS_INLINEID="sbPrePageInline_",SELECTORS_INMODALFOOTER=" div.prepage-booking-footer",SELECTORS_BOOKITBUTTON="div.booking-button-area";function closeModal(optionid){_jquery.default.each((0,_jquery.default)("[id^="+SELECTORS_MODALID+optionid+"]"),(function(){(0,_jquery.default)(this).modal("hide"),(0,_reload.reloadAllTables)()}))}function closeInline(optionid){_jquery.default.each((0,_jquery.default)("[id^="+SELECTORS_INLINEID+optionid+"]"),(function(){(0,_jquery.default)(this).collapse("toggle"),(0,_reload.reloadAllTables)()}))}}));

//# sourceMappingURL=prepageFooter.min.js.map